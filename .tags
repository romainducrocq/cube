ae36239: refactor to cython
